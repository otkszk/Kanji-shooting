/* --- ベース --- */
:root{
  --primary:#3498db;--primary2:#2980b9;--bg:#ecf0f1;--text:#2c3e50;--ok:#2ecc71;--ng:#e74c3c
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP",sans-serif}
body{display:flex;align-items:center;justify-content:center;background:#bdc3c7}
#app{width:100%;height:100%;max-width:100vw;max-height:100vh;background:#fff;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,.15);padding:2vh 2vw;display:flex;flex-direction:column}
.screen{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;gap:2vh}
h1,h2{margin:0 0 1vh;color:var(--text);text-align:center}

/* 題名下の画像 */
.top-image{
  width: 92%;
  max-width: 560px;
  height: auto;
  margin: 1vh 0 2vh;
  border-radius: 8px;
  display: block;
}

.setting-item{display:flex;gap:12px;align-items:center;justify-content:space-between;width:92%;max-width:560px}
.setting-item label{font-weight:700}
.setting-item select{flex:1;padding:10px 12px;border:1px solid #ccc;border-radius:8px;font-size:1rem}
.button-group{display:flex;gap:12px;margin-top:1vh}
button{background:var(--primary);color:#fff;border:none;padding:.8em 1.2em;border-radius:8px;cursor:pointer;font-size:clamp(.9rem,2.3vw,1rem);transition:.2s}
button:hover{background:var(--primary2);transform:translateY(-1px)}
button:disabled{background:#c8c8c8;cursor:not-allowed;transform:none}

/* --- ゲーム画面 --- */
.game-header{width:100%;display:flex;align-items:center;justify-content:space-between;padding:0 2vw}
.header-left,.header-right{display:flex;gap:10px}
#timer{font-weight:700;font-size:clamp(1.5rem,4vw,2.4rem);color:var(--text)}

#playfield{
  position:relative;
  width: min(92vw, 900px);
  height: min(60vh, 520px);
  border:2px solid #ddd;
  border-radius:12px;
  background: linear-gradient(#ffffff, #f6f9fc);
  overflow:hidden;
}
#falling{
  position:absolute;
  top:-80px;
  left:50%;
  transform:translateX(-50%);
  min-width: 120px;
  padding: 14px 18px;
  font-size: clamp(1.6rem, 5vw, 2.6rem);
  font-weight: 800;
  text-align:center;
  background:#fff;
  border:2px solid #bbb;
  border-radius:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.12);
}
#line{
  position:absolute;
  left:0; right:0;
  bottom:80px;
  height:3px;
  background: repeating-linear-gradient(90deg, #e74c3c 0 16px, transparent 16px 24px);
}

/* ビーム */
.beam{
  position:absolute;
  height:4px;
  background: radial-gradient(circle, rgba(255,255,255,.8) 0 20%, transparent 60%), linear-gradient(90deg, #7dd3fc, #60a5fa);
  box-shadow:0 0 12px rgba(96,165,250,.8);
  transform-origin:left center;
  pointer-events:none;
  z-index:3;
}

/* 3択ボタン */
.choices{
  width:min(92vw, 900px);
  display:flex;
  gap:12px;
  justify-content:center;
  align-items:center;
  margin-top:14px;
}
.choice-btn{
  flex:1;
  min-width: 0;
  padding:12px;
  font-size: clamp(1.1rem, 3.5vw, 1.4rem);
  font-weight: 700;
  border-radius:12px;
  border:2px solid #ccd;
  background:#f8fafc;
  color:#111;
}
.choice-btn:hover{transform:translateY(-1px)}
.choice-btn.incorrect{animation:shake .35s}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}

/* --- 結果・履歴 --- */
.result-header{width:100%;display:flex;align-items:center;justify-content:space-between;padding:0 2vw}
#final-time{font-weight:700;font-size:clamp(1.2rem,3.5vw,1.8rem)}
.table-wrap{width:100%;max-width:820px}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:.9em;text-align:center;font-size:clamp(.85rem,2.2vw,1rem)}
th{background:var(--bg)}

/* --- モーダル --- */
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:100;align-items:center;justify-content:center}
.modal-content{background:#fff;border-radius:12px;padding:24px;max-width:420px;width:86%;text-align:center}
#modal-message{margin-bottom:16px}
.modal-buttons{display:flex;gap:12px;justify-content:center}

/* POWER ハート無色 */
#power-display span.empty-heart {
  color: #ccc;
}

/* ゲームオーバー画面 */
#game-over {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 100;
  flex-direction: column;
  color: white;
  font-size: 2.4rem;
  font-weight: bold;
}

#game-over-buttons {
  margin-top: 20px;
  display: flex;
  gap: 20px;
}

#game-over-buttons button {
  padding: 12px 20px;
  font-size: 1.2rem;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

/* 選択肢が赤く光って揺れる */
.choice-btn.damage {
  background-color: #f8d7da;
  animation: shake .35s;
}

/* 正解時の文字拡大と赤い光 */
.falling-correct {
  animation: glowAndZoom 0.4s ease-out forwards;
}

@keyframes glowAndZoom {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 rgba(255,0,0,0);
    color: black;
  }
  50% {
    transform: scale(1.3);
    box-shadow: 0 0 20px rgba(255,0,0,0.6);
    color: red;
  }
  100% {
    transform: scale(1);
    opacity: 0;
  }
}

